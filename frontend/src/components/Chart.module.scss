@import '../styles/variables.scss';
@import '../styles/mixins.scss';

.chartContainer {
  @include card-base;
  @include fade-in;
}

.chartHeader {
  padding: var(--space-6) var(--space-6) var(--space-4);
  border-bottom: 1px solid var(--border-primary);
  
  @include mobile-only {
    padding: var(--space-4) var(--space-4) var(--space-3);
  }
}

.chartTitle {
  font-size: var(--text-lg);
  font-weight: var(--font-semibold);
  color: var(--text-primary);
  margin: 0 0 var(--space-1) 0;
  @include text-truncate;
}

.chartSubtitle {
  font-size: var(--text-sm);
  color: var(--text-muted);
  margin: 0;
  @include text-truncate;
}

.chartWrapper {
  position: relative;
  padding: var(--space-4) var(--space-6);
  
  @include mobile-only {
    padding: var(--space-3) var(--space-4);
  }
  
  // Recharts styling overrides
  :global {
    .recharts-wrapper {
      .recharts-cartesian-grid {
        .recharts-cartesian-grid-horizontal,
        .recharts-cartesian-grid-vertical {
          line {
            stroke: var(--border-primary);
            opacity: 0.5;
          }
        }
      }
      
      .recharts-xAxis,
      .recharts-yAxis {
        .recharts-text {
          fill: var(--text-muted);
          font-size: var(--text-xs);
        }
      }
      
      .recharts-legend {
        .recharts-legend-item {
          .recharts-legend-item-text {
            color: var(--text-secondary) !important;
            font-size: var(--text-sm);
          }
        }
      }
      
      .recharts-tooltip-wrapper {
        .recharts-default-tooltip {
          background: var(--bg-elevated) !important;
          border: 1px solid var(--border-primary) !important;
          border-radius: var(--radius-lg) !important;
          box-shadow: var(--shadow-lg) !important;
          
          .recharts-tooltip-label {
            color: var(--text-primary) !important;
            font-weight: var(--font-medium);
            margin-bottom: var(--space-2);
          }
          
          .recharts-tooltip-item {
            color: var(--text-secondary) !important;
            font-size: var(--text-sm);
          }
        }
      }
    }
  }
}

// Loading state
.loadingState {
  @include flex-center-column;
  height: 100%;
  color: var(--text-muted);
  gap: var(--space-3);
  
  span {
    font-size: var(--text-sm);
  }
}

.loadingSpinner {
  width: 32px;
  height: 32px;
  border: 3px solid var(--border-primary);
  border-top: 3px solid var(--primary-500);
  border-radius: var(--radius-full);
  animation: spin 1s linear infinite;
}

// Error state
.errorState {
  @include flex-center-column;
  height: 100%;
  color: var(--error-600);
  gap: var(--space-3);
  
  span {
    font-size: var(--text-sm);
  }
}

.errorIcon {
  font-size: var(--text-2xl);
}

// Empty state
.emptyState {
  @include flex-center-column;
  height: 100%;
  color: var(--text-muted);
  gap: var(--space-3);
  
  span {
    font-size: var(--text-sm);
  }
}

.emptyIcon {
  font-size: var(--text-3xl);
  opacity: 0.5;
}

// Chart container states
.chartContainer {
  &.loading {
    .chartWrapper {
      pointer-events: none;
      opacity: 0.7;
    }
  }
  
  &.error {
    border-color: var(--error-200);
    background: var(--error-50);
  }
}

// Responsive adjustments
@include mobile-only {
  .chartWrapper {
    :global {
      .recharts-wrapper {
        .recharts-legend {
          .recharts-legend-item {
            .recharts-legend-item-text {
              font-size: var(--text-xs) !important;
            }
          }
        }
        
        .recharts-xAxis,
        .recharts-yAxis {
          .recharts-text {
            font-size: 10px !important;
          }
        }
      }
    }
  }
}

// Animation for chart elements
.chartWrapper {
  :global {
    .recharts-wrapper {
      // Line chart animations
      .recharts-line {
        .recharts-line-curve {
          stroke-dasharray: 1000;
          stroke-dashoffset: 1000;
          animation: drawLine 2s ease-in-out forwards;
        }
      }
      
      // Bar chart animations
      .recharts-bar {
        rect {
          animation: growBar 0.8s ease-out forwards;
          transform-origin: bottom;
        }
      }
      
      // Area chart animations
      .recharts-area {
        .recharts-area-area {
          opacity: 0;
          animation: fillArea 1s ease-in-out 0.5s forwards;
        }
      }
      
      // Pie chart animations
      .recharts-pie {
        .recharts-pie-sector {
          transform-origin: center;
          animation: rotatePie 1s ease-out forwards;
        }
      }
    }
  }
}

// Keyframes for chart animations
@keyframes drawLine {
  to {
    stroke-dashoffset: 0;
  }
}

@keyframes growBar {
  from {
    transform: scaleY(0);
  }
  to {
    transform: scaleY(1);
  }
}

@keyframes fillArea {
  to {
    opacity: 1;
  }
}

@keyframes rotatePie {
  from {
    transform: rotate(-90deg);
  }
  to {
    transform: rotate(0deg);
  }
}

// Dark mode adjustments
:root[data-theme="dark"] {
  .chartContainer {
    &.error {
      border-color: var(--error-800);
      background: var(--error-900);
    }
  }
  
  .errorState {
    color: var(--error-400);
  }
  
  .chartWrapper {
    :global {
      .recharts-wrapper {
        .recharts-cartesian-grid {
          .recharts-cartesian-grid-horizontal,
          .recharts-cartesian-grid-vertical {
            line {
              stroke: var(--border-secondary);
              opacity: 0.3;
            }
          }
        }
        
        .recharts-xAxis,
        .recharts-yAxis {
          .recharts-text {
            fill: var(--text-muted);
          }
        }
        
        .recharts-legend {
          .recharts-legend-item {
            .recharts-legend-item-text {
              color: var(--text-secondary) !important;
            }
          }
        }
      }
    }
  }
}