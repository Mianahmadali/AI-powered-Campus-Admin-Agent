@import '../styles/variables.scss';
@import '../styles/mixins.scss';

.navbar {
  position: fixed;
  top: 0;
  right: 0;
  left: var(--sidebar-width);
  height: var(--navbar-height);
  background: var(--bg-elevated);
  border-bottom: 1px solid var(--border-primary);
  z-index: var(--z-sticky);
  transition: left var(--timing-normal) var(--ease-out);
  backdrop-filter: blur(10px);
  
  @include mobile-only {
    left: 0;
  }
  
  // Adjust for collapsed sidebar
  &:has(+ .sidebarCollapsed) {
    left: var(--sidebar-collapsed-width);
  }
}

.navbarContent {
  @include flex-between;
  height: 100%;
  padding: 0 var(--space-6);
  max-width: none;
  
  @include mobile-only {
    padding: 0 var(--space-4);
  }
}

// Left Section
.leftSection {
  @include flex-start;
  gap: var(--space-4);
  flex: 1;
  min-width: 0;
}

.mobileMenuButton {
  @include button-ghost;
  @include flex-center;
  width: 40px;
  height: 40px;
  padding: 0;
  font-size: var(--text-xl);
  
  @include desktop-up {
    display: none;
  }
}

// Search Container
.searchContainer {
  position: relative;
  flex: 1;
  max-width: 600px;
  
  @include mobile-only {
    max-width: none;
  }
  
  &.focused {
    .searchInputWrapper {
      border-color: var(--border-focus);
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      background: var(--bg-primary);
    }
    
    .searchIcon {
      color: var(--primary-500);
    }
  }
}

.searchInputWrapper {
  position: relative;
  @include flex-start;
  background: var(--bg-secondary);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-xl);
  padding: var(--space-2) var(--space-4);
  transition: all var(--timing-normal) var(--ease-out);
  
  &:hover {
    border-color: var(--border-secondary);
    background: var(--bg-primary);
  }
}

.searchIcon {
  color: var(--text-muted);
  font-size: var(--text-lg);
  margin-right: var(--space-3);
  transition: color var(--timing-normal) var(--ease-out);
}

.searchInput {
  flex: 1;
  border: none;
  background: transparent;
  color: var(--text-primary);
  font-size: var(--text-sm);
  outline: none;
  min-width: 0;
  
  &::placeholder {
    color: var(--text-muted);
  }
}

.clearSearch {
  @include flex-center;
  width: 20px;
  height: 20px;
  border-radius: var(--radius-full);
  background: var(--text-muted);
  color: var(--text-inverse);
  border: none;
  font-size: var(--text-sm);
  cursor: pointer;
  margin-left: var(--space-2);
  transition: all var(--timing-fast) var(--ease-out);
  
  &:hover {
    background: var(--text-secondary);
    transform: scale(1.1);
  }
}

// Search Suggestions
.searchSuggestions {
  position: absolute;
  top: calc(100% + var(--space-2));
  left: 0;
  right: 0;
  background: var(--bg-elevated);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-xl);
  z-index: var(--z-dropdown);
  @include slide-down;
  
  .suggestionGroup {
    padding: var(--space-3);
    
    &:not(:last-child) {
      border-bottom: 1px solid var(--border-primary);
    }
    
    h4 {
      font-size: var(--text-xs);
      font-weight: var(--font-semibold);
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: var(--space-2);
    }
  }
  
  .suggestion {
    @include flex-start;
    width: 100%;
    padding: var(--space-2) var(--space-3);
    border: none;
    background: transparent;
    color: var(--text-secondary);
    text-align: left;
    border-radius: var(--radius-md);
    gap: var(--space-3);
    font-size: var(--text-sm);
    cursor: pointer;
    transition: all var(--timing-fast) var(--ease-out);
    
    &:hover {
      background: var(--bg-secondary);
      color: var(--text-primary);
    }
  }
}

// Right Section
.rightSection {
  @include flex-end;
  gap: var(--space-2);
}

.iconButton {
  @include flex-center;
  position: relative;
  width: 40px;
  height: 40px;
  border-radius: var(--radius-lg);
  border: none;
  background: transparent;
  color: var(--text-secondary);
  font-size: var(--text-lg);
  cursor: pointer;
  transition: all var(--timing-normal) var(--ease-out);
  
  &:hover {
    background: var(--bg-secondary);
    color: var(--text-primary);
    transform: scale(1.05);
  }
  
  &.active {
    background: var(--primary-100);
    color: var(--primary-600);
  }
}

// Larger variant for language, theme, and notifications
.iconButtonLarge {
  width: 48px;
  height: 48px;
  font-size: 22px;

  .badge {
    top: 6px;
    right: 6px;
  }
}

.badge {
  position: absolute;
  top: 4px;
  right: 4px;
  @include flex-center;
  min-width: 18px;
  height: 18px;
  background: var(--error-500);
  color: var(--text-inverse);
  font-size: var(--text-xs);
  font-weight: var(--font-bold);
  border-radius: var(--radius-full);
  border: 2px solid var(--bg-elevated);
  @include bounce-in;
}

// Profile Button
.profileButton {
  @include flex-start;
  gap: var(--space-3);
  padding: var(--space-2);
  border-radius: var(--radius-lg);
  border: none;
  background: transparent;
  cursor: pointer;
  transition: all var(--timing-normal) var(--ease-out);
  
  &:hover {
    background: var(--bg-secondary);
  }
  
  &.active {
    background: var(--bg-secondary);
  }
  
  @include mobile-only {
    .profileInfo {
      display: none;
    }
  }
}

.profileAvatar {
  @include flex-center;
  width: 36px;
  height: 36px;
  border-radius: var(--radius-full);
  background: linear-gradient(135deg, var(--primary-500), var(--secondary-500));
  color: var(--text-inverse);
  font-size: var(--text-lg);
  overflow: hidden;
  
  img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }
}

.profileInfo {
  @include flex-column;
  align-items: flex-start;
  min-width: 0;
}

.profileName {
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  color: var(--text-primary);
  @include text-truncate;
}

.profileRole {
  font-size: var(--text-xs);
  color: var(--text-muted);
  @include text-truncate;
}

.dropdownArrow {
  color: var(--text-muted);
  font-size: var(--text-lg);
  transition: transform var(--timing-normal) var(--ease-out);
  
  .active & {
    transform: rotate(180deg);
  }
}

// Dropdown Container
.dropdownContainer {
  position: relative;
}

.dropdown {
  position: absolute;
  top: calc(100% + var(--space-2));
  right: 0;
  min-width: 320px;
  background: var(--bg-elevated);
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-xl);
  z-index: var(--z-dropdown);
  @include slide-down;
  
  @include mobile-only {
    left: 0;
    right: 0;
    min-width: auto;
  }
}

// Dropdown Header
.dropdownHeader {
  @include flex-between;
  padding: var(--space-4);
  border-bottom: 1px solid var(--border-primary);
  
  h3 {
    font-size: var(--text-lg);
    font-weight: var(--font-semibold);
    color: var(--text-primary);
    margin: 0;
  }
}

.clearAllButton {
  @include button-ghost;
  font-size: var(--text-sm);
  padding: var(--space-1) var(--space-2);
  height: auto;
  min-height: auto;
}

// Notification List
.notificationList {
  max-height: 400px;
  overflow-y: auto;
  @include custom-scrollbar;
}

.notificationItem {
  @include flex-start;
  padding: var(--space-4);
  border-bottom: 1px solid var(--border-primary);
  cursor: pointer;
  transition: background-color var(--timing-fast) var(--ease-out);
  position: relative;
  
  &:hover {
    background: var(--bg-secondary);
  }
  
  &.unread {
    background: var(--primary-50);
    
    &:hover {
      background: var(--primary-100);
    }
  }
  
  &:last-child {
    border-bottom: none;
  }
}

.notificationContent {
  flex: 1;
  min-width: 0;
}

.notificationTitle {
  font-size: var(--text-sm);
  font-weight: var(--font-medium);
  color: var(--text-primary);
  margin-bottom: var(--space-1);
  @include text-truncate;
}

.notificationMessage {
  font-size: var(--text-sm);
  color: var(--text-secondary);
  margin-bottom: var(--space-1);
  @include text-truncate-lines(2);
}

.notificationTime {
  font-size: var(--text-xs);
  color: var(--text-muted);
}

.unreadIndicator {
  width: 8px;
  height: 8px;
  border-radius: var(--radius-full);
  background: var(--primary-500);
  margin-left: var(--space-3);
  flex-shrink: 0;
}

.emptyState {
  @include flex-center-column;
  padding: var(--space-8);
  color: var(--text-muted);
  
  svg {
    font-size: var(--text-3xl);
    margin-bottom: var(--space-2);
    color: var(--accent-500);
  }
}

// Dropdown Footer
.dropdownFooter {
  padding: var(--space-3);
  border-top: 1px solid var(--border-primary);
}

.viewAllButton {
  @include button-primary;
  width: 100%;
  justify-content: center;
}

// Profile Dropdown
.profileDropdownHeader {
  @include flex-start;
  padding: var(--space-4);
  border-bottom: 1px solid var(--border-primary);
  gap: var(--space-3);
  
  .profileAvatar {
    width: 48px;
    height: 48px;
    font-size: var(--text-xl);
  }
}

.profileDetails {
  @include flex-column;
  align-items: flex-start;
  min-width: 0;
  
  .profileName {
    font-size: var(--text-base);
    font-weight: var(--font-semibold);
    color: var(--text-primary);
    margin-bottom: var(--space-1);
  }
  
  .profileEmail {
    font-size: var(--text-sm);
    color: var(--text-muted);
    @include text-truncate;
  }
  
  .profileDepartment {
    font-size: var(--text-xs);
    color: var(--text-muted);
    padding: var(--space-1) var(--space-2);
    background: var(--bg-secondary);
    border-radius: var(--radius-sm);
    margin-top: var(--space-1);
    @include text-truncate;
  }
}

.profileDropdownContent {
  padding: var(--space-2);
}

.profileMenuItem {
  @include flex-start;
  width: 100%;
  padding: var(--space-3);
  border: none;
  background: transparent;
  color: var(--text-secondary);
  font-size: var(--text-sm);
  border-radius: var(--radius-md);
  gap: var(--space-3);
  cursor: pointer;
  transition: all var(--timing-fast) var(--ease-out);
  
  &:hover {
    background: var(--bg-secondary);
    color: var(--text-primary);
  }
  
  &.danger {
    color: var(--error-600);
    
    &:hover {
      background: var(--error-50);
      color: var(--error-700);
    }
  }
}

.dropdownDivider {
  height: 1px;
  background: var(--border-primary);
  margin: var(--space-2) 0;
}

// Responsive adjustments
@include tablet-up {
  .navbar {
    left: var(--sidebar-width);
    
    &.sidebarCollapsed {
      left: var(--sidebar-collapsed-width);
    }
  }
}

// Dark mode adjustments
:root[data-theme="dark"] {
  .navbar {
    .searchInputWrapper {
      background: var(--bg-tertiary);
      
      &:hover {
        background: var(--bg-secondary);
      }
    }
    
    .iconButton {
      &.active {
        background: var(--primary-800);
        color: var(--primary-300);
      }
    }
    
    .notificationItem {
      &.unread {
        background: var(--primary-900);
        
        &:hover {
          background: var(--primary-800);
        }
      }
    }
    
    .profileMenuItem {
      &.danger {
        color: var(--error-400);
        
        &:hover {
          background: var(--error-900);
          color: var(--error-300);
        }
      }
    }
  }
}